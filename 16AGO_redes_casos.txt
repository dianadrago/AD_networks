
library(plyr)
library(minet)
library(igraph)

adjs <- sort(list.files(pattern="*.adj"))

length(adjs)

adjtosqmtx <- function(g){
  a <- scan(file = g, skip = 17, what = "")
  m <- matrix(unlist(a[-(1)]), ncol = 2, byrow = T)
  rownames(m) <- c(m[,1])
  m <- t(m[,2])
  m
}

M <- lapply(adjs, adjtosqmtx)

> length(adjs)                                                                                                                                          
((12169**2)-12169)/2
[1] 74036196

x <- t(rbind.fill.matrix(M))
dim(x)
[1] 12169 12169

x[is.na(x)] <- 0
x[1:5, 1:5]
class(x) <- "numeric"
names <- gsub('.{6}$','', adjs)
colnames(x) <- names
x[1:5, 1:5]
isSymmetric(x)
[1] FALSE

x <- x[sort(rownames(x)), sort(colnames(x)) ]
isSymmetric(x)
[1] TRUE

x[1:5, 1:5]   

write.table(x, file = "x.adj_casos.txt", sep = "\t", col.names= NA, row.names= T, quote = F )
xg <- graph.adjacency(adjmatrix= x, mode='undirected', diag=F, weighted=T)
xsif <- get.data.frame(xg)
write.table(xsif, file = "x.sif_casos.txt", sep = "\t", col.names= T, row.names= F, quote = F )

normalit<-function(m){
     (m - min(m[upper.tri(m)]))/(max(m)-min(m[upper.tri(m)]))
}
x_norm <- (normalit(x)) 
diag(x_norm) <- 0
min(x)
[1] 0

min(x_norm)                                                                                                       
[1] 0

max(x)                                                                                                            
0.657639

max(x_norm)                                                                                                       
[1] 1

write.table(x_norm, file = "x.adj_norm_casos.txt", sep = "\t", col.names= NA, row.names= T, quote = F )                 
xg_norm <- graph.adjacency(adjmatrix= x_norm, mode='undirected', diag=F, weighted=T)                                  
xsif_norm <- get.data.frame(xg_norm)                                                                            
write.table(xsif_norm, file = "x.sif_norm_casos.txt", sep = "\t", col.names= T, row.names= F, quote = F )

casos_q <- x_norm[upper.tri(x_norm, diag=FALSE)]
quantile(casos_q)
quantile(casos_q, probs=seq(0.995, 1, 0.00001))

99.500%   99.501%   99.502%   99.503%   99.504%   99.505%   99.506%   99.507%
0.5093521 0.5094947 0.5096362 0.5097848 0.5099357 0.5100813 0.5102312 0.5103760
  99.508%   99.509%   99.510%   99.511%   99.512%   99.513%   99.514%   99.515%
0.5105193 0.5106708 0.5108163 0.5109618 0.5111044 0.5112441 0.5113852 0.5115322
  99.516%   99.517%   99.518%   99.519%   99.520%   99.521%   99.522%   99.523%
0.5116718 0.5118144 0.5119570 0.5120998 0.5122528 0.5123980 0.5125469 0.5126979
  99.524%   99.525%   99.526%   99.527%   99.528%   99.529%   99.530%   99.531%
0.5128391 0.5129875 0.5131426 0.5132962 0.5134447 0.5135976 0.5137402 0.5138883
  99.532%   99.533%   99.534%   99.535%   99.536%   99.537%   99.538%   99.539%
0.5140401 0.5141885 0.5143355 0.5144811 0.5146295 0.5147795 0.5149485 0.5151000
  99.540%   99.541%   99.542%   99.543%   99.544%   99.545%   99.546%   99.547%
0.5152455 0.5153998 0.5155483 0.5157061 0.5158635 0.5160143 0.5161790 0.5163407
  99.548%   99.549%   99.550%   99.551%   99.552%   99.553%   99.554%   99.555%
0.5164935 0.5166538 0.5168151 0.5169816 0.5171359 0.5172932 0.5174491 0.5176049
  99.556%   99.557%   99.558%   99.559%   99.560%   99.561%   99.562%   99.563%
0.5177504 0.5179062 0.5180635 0.5182193 0.5183752 0.5185442 0.5186942 0.5188529
  99.564%   99.565%   99.566%   99.567%   99.568%   99.569%   99.570%   99.571%
0.5190220 0.5191866 0.5193557 0.5195100 0.5196859 0.5198555 0.5200025 0.5201668
  99.572%   99.573%   99.574%   99.575%   99.576%   99.577%   99.578%   99.579%
0.5203301 0.5204905 0.5206522 0.5208066 0.5209830 0.5211491 0.5213140 0.5214769
  99.580%   99.581%   99.582%   99.583%   99.584%   99.585%   99.586%   99.587%
0.5216475 0.5218180 0.5219900 0.5221664 0.5223325 0.5225097 0.5226735 0.5228338
  99.588%   99.589%   99.590%   99.591%   99.592%   99.593%   99.594%   99.595%
0.5229984 0.5231616 0.5233365 0.5235129 0.5236746 0.5238466 0.5240289 0.5242053
  99.596%   99.597%   99.598%   99.599%   99.600%   99.601%   99.602%   99.603%
0.5243846 0.5245610 0.5247301 0.5248977 0.5250814 0.5252549 0.5254254 0.5256048
  99.604%   99.605%   99.606%   99.607%   99.608%   99.609%   99.610%   99.611%
0.5257878 0.5259723 0.5261516 0.5263280 0.5265029 0.5266867 0.5268631 0.5270322
  99.612%   99.613%   99.614%   99.615%   99.616%   99.617%   99.618%   99.619%
0.5272159 0.5273953 0.5275658 0.5277437 0.5279245 0.5280997 0.5282832 0.5284684
  99.620%   99.621%   99.622%   99.623%   99.624%   99.625%   99.626%   99.627%
0.5286462 0.5288344 0.5290211 0.5292100 0.5293945 0.5295871 0.5297835 0.5299590
  99.628%   99.629%   99.630%   99.631%   99.632%   99.633%   99.634%   99.635%
0.5301486 0.5303394 0.5305350 0.5307159 0.5309100 0.5310997 0.5312879 0.5314863
  99.636%   99.637%   99.638%   99.639%   99.640%   99.641%   99.642%   99.643%
0.5316760 0.5318703 0.5320611 0.5322434 0.5324336 0.5326271 0.5328197 0.5330078
  99.644%   99.645%   99.646%   99.647%   99.648%   99.649%   99.650%   99.651%
0.5331916 0.5333886 0.5335870 0.5337796 0.5339619 0.5341500 0.5343455 0.5345440
  99.652%   99.653%   99.654%   99.655%   99.656%   99.657%   99.658%   99.659%
0.5347557 0.5349438 0.5351408 0.5353305 0.5355392 0.5357450 0.5359405 0.5361360
  99.660%   99.661%   99.662%   99.663%   99.664%   99.665%   99.666%   99.667%
0.5363286 0.5365300 0.5367366 0.5369357 0.5371474 0.5373591 0.5375605 0.5377810
  99.668%   99.669%   99.670%   99.671%   99.672%   99.673%   99.674%   99.675%
0.5379956 0.5381970 0.5384116 0.5386218 0.5388174 0.5390246 0.5392348 0.5394407
  99.676%   99.677%   99.678%   99.679%   99.680%   99.681%   99.682%   99.683%
0.5396586 0.5398836 0.5400909 0.5402977 0.5405167 0.5407350 0.5409474 0.5411644
  99.684%   99.685%   99.686%   99.687%   99.688%   99.689%   99.690%   99.691%
0.5413679 0.5415722 0.5417912 0.5419956 0.5422322 0.5424469 0.5426688 0.5428790
  99.692%   99.693%   99.694%   99.695%   99.696%   99.697%   99.698%   99.699%
0.5430849 0.5433156 0.5435467 0.5437611 0.5439919 0.5442138 0.5444446 0.5446710
  99.700%   99.701%   99.702%   99.703%   99.704%   99.705%   99.706%   99.707%
0.5449018 0.5451223 0.5453458 0.5455986 0.5458201 0.5460528 0.5462645 0.5464909
  99.708%   99.709%   99.710%   99.711%   99.712%   99.713%   99.714%   99.715%
0.5467202 0.5469584 0.5472142 0.5474523 0.5476875 0.5479242 0.5481564 0.5483740
  99.716%   99.717%   99.718%   99.719%   99.720%   99.721%   99.722%   99.723%
0.5486067 0.5488400 0.5490855 0.5493376 0.5495758 0.5498258 0.5500616 0.5503027
  99.724%   99.725%   99.726%   99.727%   99.728%   99.729%   99.730%   99.731%
0.5505482 0.5507907 0.5510289 0.5512582 0.5515184 0.5517594 0.5520109 0.5522475
  99.732%   99.733%   99.734%   99.735%   99.736%   99.737%   99.738%   99.739%
0.5524827 0.5527268 0.5529708 0.5532119 0.5534735 0.5537402 0.5539924 0.5542526
  99.740%   99.741%   99.742%   99.743%   99.744%   99.745%   99.746%   99.747%
0.5545217 0.5547921 0.5550567 0.5553077 0.5555580 0.5558370 0.5560961 0.5563840
  99.748%   99.749%   99.750%   99.751%   99.752%   99.753%   99.754%   99.755%
0.5566458 0.5568958 0.5571795 0.5574573 0.5577190 0.5579850 0.5582541 0.5585187
  99.756%   99.757%   99.758%   99.759%   99.760%   99.761%   99.762%   99.763%
0.5587818 0.5590640 0.5593375 0.5596146 0.5598902 0.5601601 0.5604268 0.5606914
  99.764%   99.765%   99.766%   99.767%   99.768%   99.769%   99.770%   99.771%
0.5609633 0.5612382 0.5615028 0.5617909 0.5620717 0.5623745 0.5626538 0.5629437
  99.772%   99.773%   99.774%   99.775%   99.776%   99.777%   99.778%   99.779%
0.5632333 0.5635344 0.5638225 0.5641136 0.5644141 0.5647060 0.5650029 0.5652911
  99.780%   99.781%   99.782%   99.783%   99.784%   99.785%   99.786%   99.787%
0.5655763 0.5658629 0.5661599 0.5664576 0.5667697 0.5670786 0.5673785 0.5676857
  99.788%   99.789%   99.790%   99.791%   99.792%   99.793%   99.794%   99.795%
0.5679783 0.5682870 0.5686047 0.5689132 0.5692175 0.5695262 0.5698354 0.5701451
  99.796%   99.797%   99.798%   99.799%   99.800%   99.801%   99.802%   99.803%
0.5704523 0.5707699 0.5711065 0.5714314 0.5717601 0.5720679 0.5724001 0.5727306
  99.804%   99.805%   99.806%   99.807%   99.808%   99.809%   99.810%   99.811%
0.5730484 0.5733747 0.5736967 0.5740363 0.5743641 0.5747213 0.5750682 0.5754008
  99.812%   99.813%   99.814%   99.815%   99.816%   99.817%   99.818%   99.819%
0.5757371 0.5760904 0.5764471 0.5768161 0.5771681 0.5775143 0.5778730 0.5782494
  99.820%   99.821%   99.822%   99.823%   99.824%   99.825%   99.826%   99.827%
0.5786022 0.5789575 0.5793151 0.5796738 0.5800281 0.5803940 0.5807543 0.5811541
  99.828%   99.829%   99.830%   99.831%   99.832%   99.833%   99.834%   99.835%
0.5815218 0.5818864 0.5822684 0.5826447 0.5830303 0.5833886 0.5837737 0.5841883
  99.836%   99.837%   99.838%   99.839%   99.840%   99.841%   99.842%   99.843%
0.5845808 0.5849688 0.5853422 0.5857225 0.5861239 0.5865065 0.5869078 0.5872959
  99.844%   99.845%   99.846%   99.847%   99.848%   99.849%   99.850%   99.851%
0.5877119 0.5881176 0.5885014 0.5889026 0.5893115 0.5897332 0.5901349 0.5905524
  99.852%   99.853%   99.854%   99.855%   99.856%   99.857%   99.858%   99.859%
0.5909876 0.5914076 0.5918118 0.5922308 0.5926968 0.5931122 0.5935259 0.5939679
  99.860%   99.861%   99.862%   99.863%   99.864%   99.865%   99.866%   99.867%
0.5944002 0.5948592 0.5953075 0.5957486 0.5962028 0.5966850 0.5971320 0.5975978
  99.868%   99.869%   99.870%   99.871%   99.872%   99.873%   99.874%   99.875%
0.5980668 0.5985254 0.5990061 0.5994707 0.5999181 0.6004129 0.6008877 0.6013552
  99.876%   99.877%   99.878%   99.879%   99.880%   99.881%   99.882%   99.883%
0.6018653 0.6023587 0.6028322 0.6033471 0.6038260 0.6043203 0.6047936 0.6052800
  99.884%   99.885%   99.886%   99.887%   99.888%   99.889%   99.890%   99.891%
0.6057800 0.6062842 0.6067901 0.6072973 0.6078042 0.6083393 0.6088671 0.6093659
  99.892%   99.893%   99.894%   99.895%   99.896%   99.897%   99.898%   99.899%
0.6098938 0.6104495 0.6110082 0.6115977 0.6121408 0.6127078 0.6132566 0.6138622
  99.900%   99.901%   99.902%   99.903%   99.904%   99.905%   99.906%   99.907%
0.6144414 0.6149971 0.6155982 0.6162010 0.6168200 0.6174226 0.6180150 0.6186560
  99.908%   99.909%   99.910%   99.911%   99.912%   99.913%   99.914%   99.915%
0.6192852 0.6198732 0.6205807 0.6212400 0.6218672 0.6225530 0.6232198 0.6239260
  99.916%   99.917%   99.918%   99.919%   99.920%   99.921%   99.922%   99.923%
0.6245978 0.6252490 0.6259768 0.6266409 0.6273644 0.6280861 0.6287976 0.6294886
  99.924%   99.925%   99.926%   99.927%   99.928%   99.929%   99.930%   99.931%
0.6302414 0.6309809 0.6317103 0.6324649 0.6332141 0.6339844 0.6347386 0.6355657
  99.932%   99.933%   99.934%   99.935%   99.936%   99.937%   99.938%   99.939%
0.6363617 0.6371526 0.6379442 0.6387704 0.6396421 0.6404576 0.6412735 0.6421159
  99.940%   99.941%   99.942%   99.943%   99.944%   99.945%   99.946%   99.947%
0.6429906 0.6439051 0.6447828 0.6457633 0.6466629 0.6476155 0.6485566 0.6495019
  99.948%   99.949%   99.950%   99.951%   99.952%   99.953%   99.954%   99.955%
0.6505604 0.6515083 0.6525333 0.6535610 0.6546378 0.6556742 0.6567056 0.6577847
  99.956%   99.957%   99.958%   99.959%   99.960%   99.961%   99.962%   99.963%
0.6589211 0.6601024 0.6612000 0.6623863 0.6636136 0.6649500 0.6662556 0.6675360
  99.964%   99.965%   99.966%   99.967%   99.968%   99.969%   99.970%   99.971%
0.6688653 0.6703045 0.6717122 0.6731944 0.6746361 0.6760825 0.6776612 0.6792762
  99.972%   99.973%   99.974%   99.975%   99.976%   99.977%   99.978%   99.979%
0.6810197 0.6828667 0.6846464 0.6865884 0.6885014 0.6903357 0.6924047 0.6944998
  99.980%   99.981%   99.982%   99.983%   99.984%   99.985%   99.986%   99.987%
0.6966599 0.6990400 0.7015308 0.7041821 0.7068404 0.7096759 0.7127410 0.7159722
  99.988%   99.989%   99.990%   99.991%   99.992%   99.993%   99.994%   99.995%
0.7194010 0.7231449 0.7272450 0.7317974 0.7372391 0.7430020 0.7494047 0.7577819
  99.996%   99.997%   99.998%   99.999%  100.000%
0.7672463 0.7790428 0.7948091 0.8229376 1.0000000

### 99.640%= 0.5324336 
pvalue= 
mi2p <- function(mi, n){
  alfa <- 1.062
  beta <- -48.7
  gamma <- -0.634
  x <- exp(-((mi*((-beta) + (-gamma)*n)) - alfa))
  return(x)
}

mi2p(0.5324336)
[1] 

x_norm[x_norm < 0.5324336] <- 0
write.table(x_norm, file = "casos_norm_fpvalue.txt", sep = "\t", col.names= NA, row.names= T, quote = F)
xg_norm_fpvalue <- graph.adjacency(adjmatrix= x_norm, mode='undirected', diag=F, weighted=T)
xsif_norm_fpvalue <- get.data.frame(xg_norm_fpvalue)
write.table(xsif_norm_fpvalue, file = "casos_norm_fpvalue_sif.txt", sep = "\t", col.names= T, row.names= F, quote = F )
xdpi <- aracne(mim =  x_norm, eps = 0.1)

write.table(xdpi, file = "casos_norm_fpvalue_dpi.txt", sep = "\t", col.names= NA, row.names= T, quote = F)
xg_norm_fpvalue_dpi <- graph.adjacency(adjmatrix= xdpi, mode='undirected', diag=F, weighted=T)
xsif_norm_fpvalue_dpi <- get.data.frame(xg_norm_fpvalue_dpi)
write.table(xsif_norm_fpvalue_dpi, file = "casos_norm_fpvalue_sif_dpi.txt", sep = "\t", col.names= T, row.names= F, quote = F )
